---
- import_tasks: tasks/centos_prerequisites.yml
  when: ansible_distribution == "CentOS"

- name: install git tools
  become: yes
  package: name={{ item }}
  with_items:
    - git
    - git-gui
    - gitk

- name: set user global git settings
  git_config:
    scope: global
    name: "{{ item.name }}"
    value: "{{ item.value }}"
  with_items:
    - {name: 'user.name', value: '{{ git_user_name }}'}
    - {name: 'user.email', value: '{{ git_user_email }}'}

- name: set user global push strategy to simple
  git_config:
    scope: global
    name: "push.default"
    value: "simple"

- name: set user global pull strategy to always use --rebase
  git_config:
    scope: global
    name: "pull.rebase"
    value: "true"

- name: add user global git aliases
  git_config:
    scope: global
    name: "{{ item.name }}"
    value: "{{ item.value }}"
  with_items:
    - {name: 'alias.co', value: 'checkout'}
    - {name: 'alias.cob', value: 'checkout -b'}
    - {name: 'alias.ci', value: 'commit'}
    - {name: 'alias.st', value: 'status --short'}
    - {name: 'alias.br', value: 'branch'}
    - {name: 'alias.rpo', value: 'remote prune origin'}
    - {name: 'alias.spu', value: 'stash push'}
    - {name: 'alias.spo', value: 'stash pop'}
    - {name: 'alias.sdr', value: 'stash drop'}
    - {name: 'alias.ri', value: 'rebase -i'}
    - {name: 'alias.ro', value: 'rebase --onto'}
    - {name: 'alias.ra', value: 'rebase --abort'}
    - {name: 'alias.rc', value: 'rebase --continue'}
    - {name: 'alias.rs', value: 'rebase --skip'}
    - {name: 'alias.ma', value: 'merge --abort'}
    - {name: 'alias.mc', value: 'merge --continue'}
    - {name: 'alias.mq', value: 'merge --quit'}
    - {name: 'alias.bb', value: 'bisect bad'}
    - {name: 'alias.bg', value: 'bisect good'}
    - {name: 'alias.bs', value: 'bisect skip'}
    - {name: 'alias.pushfwl', value: 'push --force-with-lease'}
    - {name: 'alias.chp', value: 'cherry-pick'}
    - {name: 'alias.rh', value: 'reset --hard'}
    - {name: 'alias.k', value: "!gitk --all"}
    - {name: 'alias.g', value: "!git gui"}
    - {name: 'alias.fix', value: "!fix() { git commit --fixup $1 && GIT_SEQUENCE_EDITOR=: git rebase --interactive --autosquash --autostash $1~1; }; fix"}
    - {name: 'alias.l', value: 'log --oneline'}
    - {name: 'alias.graph', value: "log --graph --abbrev-commit --date=iso --pretty=format:'%Cred%h%Creset %Cgreen(%cd) %C(bold blue)<%an>%Creset -%C(yellow)%d%Creset %s'"}

- import_tasks: tasks/archivestotext.yml
  when: git_archivestotext
- import_tasks: tasks/docxtotext.yml
  when: git_docxtotext
- import_tasks: tasks/pdftotext.yml
  when: git_pdftotext
- import_tasks: tasks/xlsxtotext.yml
  when: git_xlsxtotext

- import_tasks: tasks/rerere.yml
  when: git_rerere

- import_tasks: tasks/editor_nano.yml
  when: git_editor_nano

- import_tasks: tasks/prompt.yml
  when: git_prompt
